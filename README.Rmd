---
title: "DS 2020 Final Project Report"
author: "David Wang, Logan Pappas"
date: "2025-11-30"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# load the data and library
library(tidyverse)

electric_vehicle_population_data <- read_csv("Electric_Vehicle_Population_Data.csv")

head(electric_vehicle_population_data)
glimpse(electric_vehicle_population_data)
dim(electric_vehicle_population_data)
```
Topic:
Differences in electric range across various vehicle makes and models

How does electric range differ across vehicle makes?
How does electric range differ across models?
How does electric range differ across models within the same make?
Do newer models within the same make tend to have higher range?
How does electric range differ between BEVs and PHEVs across makes?
Do average electric ranges differ across cities?


```{r}
###cleaning to find median
electric_vehicle_population_data <- electric_vehicle_population_data %>%
  mutate(
    `Electric Range` = replace_na(`Electric Range`, median(`Electric Range`, na.rm = TRUE)),
    `Base MSRP` = replace_na(`Base MSRP`, median(`Base MSRP`, na.rm = TRUE))
  )

```

```{r}
#fixing data types
electric_vehicle_population_data <- electric_vehicle_population_data |>
  mutate(
    `Model Year` = as.integer(`Model Year`),
    `Postal Code` = as.character(`Postal Code`),
    `Legislative District` = as.factor(`Legislative District`),
    State = as.factor(State),
    `Electric Vehicle Type` = as.factor(`Electric Vehicle Type`),
    `Clean Alternative Fuel Vehicle (CAFV) Eligibility` =
      as.factor(`Clean Alternative Fuel Vehicle (CAFV) Eligibility`)
  )

#remove dupes
electric_vehicle_population_data <- electric_vehicle_population_data |>
  distinct(`VIN (1-10)`, `Model Year`, .keep_all = TRUE)

glimpse(electric_vehicle_population_data)

dim(electric_vehicle_population_data)
```

```{r}
library(tidyverse)
ev_plot <- electric_vehicle_population_data |>
  filter(!is.na(`Electric Range`), `Electric Range` > 0)

```


```{r}
#How does electric range differ across vehicle makes?

ev_plot |>
  ggplot(aes(x = reorder(Make, `Electric Range`, FUN = median),
             y = `Electric Range`)) +
  geom_boxplot() +
  coord_flip() +
  labs(
    title = "Electric Range Distribution by Vehicle Make",
    x = "Make",
    y = "Electric Range (miles)"
  )

```
